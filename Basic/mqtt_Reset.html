<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ESP32 MQTT Reset</title>
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<style>
    body { font-family: Arial; margin: 40px; }
    button { padding: 12px 20px; font-size: 18px; }
    #log { margin-top: 20px; font-family: monospace; white-space: pre; }
</style>
</head>
<body>

<h2>ESP32 MQTT ì›ê²© Reset</h2>

<button id="btnReset">ğŸ”„ ESP32 Reset ì‹¤í–‰</button>

<div id="log"></div>

<script>
    const log = (msg) => {
        document.getElementById("log").textContent += msg + "\n";
    };

    // ===== HiveMQ Cloud ì ‘ì† ì„¤ì • =====
    const options = {
        username: "mqtt_ESP32",
        password: "gomqtt_ESP32",
        reconnectPeriod: 2000,
        clean: true,
        connectTimeout: 4000
    };

    // HiveMQ Cloud WebSocket ì£¼ì†Œ
    const client = mqtt.connect(
        "wss://6c56aefe0ddb4d57977c735f5070abe8.s1.eu.hivemq.cloud:8884/mqtt",
        options
    );

    client.on("connect", () => {
        log("MQTT ì„œë²„ ì—°ê²° ì™„ë£Œ!");
        client.subscribe("esp32/response");
    });

    client.on("error", (err) => {
        log("MQTT ì—°ê²° ì˜¤ë¥˜: " + err);
    });

    client.on("message", (topic, message) => {
        log("[ì‘ë‹µ] " + topic + ": " + message.toString());
    });

    // ===== Reset ë²„íŠ¼ í´ë¦­ =====
    document.getElementById("btnReset").addEventListener("click", () => {
        log("Reset ëª…ë ¹ ì „ì†¡...");
        client.publish("esp32/reset", "1");   // ESP32ê°€ êµ¬ë…í•˜ëŠ” Topic
    });
</script>

</body>
</html>
